from __future__ import division
from jinja2.runtime import LoopContext, TemplateReference, Macro, Markup, TemplateRuntimeError, missing, concat, escape, markup_join, unicode_join, to_string, identity, TemplateNotFound, Namespace
name = 'pages/profile/Profile.js'

def root(context, missing=missing):
    resolve = context.resolve_or_missing
    undefined = environment.undefined
    if 0: yield None
    pass
    yield u'// Copyright 2014 The Oppia Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the "License");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an "AS-IS" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Data and controllers for the Oppia profile page.\n */\n\noppia.controller(\'Profile\', [\n  \'$scope\', \'$http\', \'$rootScope\', \'$log\', \'DateTimeFormatService\',\n  \'UrlInterpolationService\',\n  function($scope, $http, $rootScope, $log, DateTimeFormatService,\n      UrlInterpolationService) {\n    var profileDataUrl = \'/profilehandler/data/\' + GLOBALS.PROFILE_USERNAME;\n    var DEFAULT_PROFILE_PICTURE_URL = UrlInterpolationService.getStaticImageUrl(\n      \'/general/no_profile_picture.png\');\n\n    $scope.getLocaleDateString = function(millisSinceEpoch) {\n      return DateTimeFormatService.getLocaleDateString(millisSinceEpoch);\n    };\n\n    $rootScope.loadingMessage = \'Loading\';\n    $http.get(profileDataUrl).then(function(response) {\n      var data = response.data;\n      $rootScope.loadingMessage = \'\';\n      $scope.username = {\n        title: \'Username\',\n        value: data.profile_username,\n        helpText: (data.profile_username)\n      };\n      $scope.usernameIsLong = data.profile_username.length > 16;\n      $scope.userBio = data.user_bio;\n      $scope.userDisplayedStatistics = [{\n        title: \'Impact\',\n        value: data.user_impact_score,\n        helpText: (\n          \'A rough measure of the impact of explorations created by this \' +\n          \'user. Better ratings and more playthroughs improve this score.\')\n      }, {\n        title: \'Created\',\n        value: data.created_exp_summary_dicts.length\n      }, {\n        title: \'Edited\',\n        value: data.edited_exp_summary_dicts.length\n      }];\n\n      $scope.userEditedExplorations = data.edited_exp_summary_dicts.sort(\n        function(exploration1, exploration2) {\n          if (exploration1.ratings > exploration2.ratings) {\n            return 1;\n          } else if (exploration1.ratings === exploration2.ratings) {\n            if (exploration1.playthroughs > exploration2.playthroughs) {\n              return 1;\n            } else if (exploration1.playthroughs > exploration2.playthroughs) {\n              return 0;\n            } else {\n              return -1;\n            }\n          } else {\n            return -1;\n          }\n        }\n      );\n\n      $scope.userNotLoggedIn = !data.username;\n\n      $scope.isAlreadySubscribed = data.is_already_subscribed;\n      $scope.isUserVisitingOwnProfile = data.is_user_visiting_own_profile;\n\n      $scope.subscriptionButtonPopoverText = \'\';\n\n      $scope.currentPageNumber = 0;\n      $scope.PAGE_SIZE = 6;\n      $scope.startingExplorationNumber = 1;\n      $scope.endingExplorationNumber = 6;\n      $scope.Math = window.Math;\n      $scope.profileIsOfCurrentUser = data.profile_is_of_current_user;\n\n      $scope.changeSubscriptionStatus = function() {\n        if ($scope.userNotLoggedIn) {\n          window.location.href = GLOBALS.loginUrl;\n        } else {\n          if (!$scope.isAlreadySubscribed) {\n            $scope.isAlreadySubscribed = true;\n            $http.post(\'/subscribehandler\', {\n              creator_username: data.profile_username\n            });\n          } else {\n            $scope.isAlreadySubscribed = false;\n            $http.post(\'/unsubscribehandler\', {\n              creator_username: data.profile_username\n            });\n          }\n          $scope.updateSubscriptionButtonPopoverText();\n        }\n      };\n\n      $scope.updateSubscriptionButtonPopoverText = function() {\n        if ($scope.userNotLoggedIn) {\n          $scope.subscriptionButtonPopoverText = (\n            \'Log in or sign up to subscribe to your favorite creators.\');\n        } else if ($scope.isAlreadySubscribed) {\n          $scope.subscriptionButtonPopoverText = (\n            \'Unsubscribe to stop receiving email notifications regarding new \' +\n            \'explorations published by \' + $scope.username.value + \'.\');\n        } else {\n          $scope.subscriptionButtonPopoverText = (\n            \'Receive email notifications, whenever \' +\n            $scope.username.value + \' publishes a new exploration.\');\n        }\n      };\n      $scope.updateSubscriptionButtonPopoverText();\n\n      $scope.goToPreviousPage = function() {\n        if ($scope.currentPageNumber === 0) {\n          $log.error(\'Error: cannot decrement page\');\n        } else {\n          $scope.currentPageNumber--;\n        }\n      };\n      $scope.goToNextPage = function() {\n        if ($scope.currentPageNumber * $scope.PAGE_SIZE >= (\n          data.edited_exp_summary_dicts.length)) {\n          $log.error(\'Error: Cannot increment page\');\n        } else {\n          $scope.currentPageNumber++;\n        }\n      };\n\n      $scope.getExplorationsToDisplay = function() {\n        $scope.explorationsOnPage = [];\n        if ($scope.userEditedExplorations.length === 0) {\n          return $scope.explorationsOnPage;\n        }\n        $scope.explorationIndexStart = (\n          $scope.currentPageNumber * $scope.PAGE_SIZE);\n        $scope.explorationIndexEnd = (\n          $scope.explorationIndexStart + $scope.PAGE_SIZE - 1);\n        for (var ind = $scope.explorationIndexStart;\n          ind <= $scope.explorationIndexEnd; ind++) {\n          $scope.explorationsOnPage.push($scope.userEditedExplorations[ind]);\n          if (ind === $scope.userEditedExplorations.length - 1) {\n            break;\n          }\n        }\n        return $scope.explorationsOnPage;\n      };\n\n      $scope.numUserPortfolioExplorations = (\n        data.edited_exp_summary_dicts.length);\n      $scope.subjectInterests = data.subject_interests;\n      $scope.firstContributionMsec = data.first_contribution_msec;\n      $scope.profilePictureDataUrl = (\n        data.profile_picture_data_url || DEFAULT_PROFILE_PICTURE_URL);\n      $rootScope.loadingMessage = \'\';\n    });\n  }\n]);'

blocks = {}
debug_info = ''